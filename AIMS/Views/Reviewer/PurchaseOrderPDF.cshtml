@model AIMS.Models.PurchaseOrder

@{
    ViewBag.Title = "Index";
    Layout = null;
    //Layout = "~/Views/Shared/_Sample.cshtml";
    var imagePath = Server.MapPath("~/Content/Images");
}
<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/Site")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Content/jquery-1.5.1.min.js")" type="text/javascript"></script>
    <style>
        body {
            font-size: 15px !important;
            font-family: Calibri;
        }

        table {
            border-collapse: collapse;
        }

        .bordered-table tr td {
            margin: 5px;
            padding: 2px;
            border: 1px solid black;
            height: 20px;
        }

        .bordered-table tr th {
            font-size: 13px !important;
            border: 1px solid black;
            height: 25px;
        }

        .table-purchase-order tr td {
            margin: 5px;
            padding: 2px;
            border: 1px solid black;
            height: 22px;
        }

        .no-table-border tr td {
            margin: 5px;
            border: 1px solid white;
        }

        .item-table tr th {
            font-size: 13px !important;
            border-left: 1px solid black;
            border-bottom: 1px solid black;
            height: 20px;
        }

        .underlined-text{
            text-decoration:underline;
        } /*Underlined Text Added*/
        .item-table tr td {
            font-size: 12px !important;
            border-left: 1px;
            border-bottom: 0px;
            height: 20px;
        }

        .item-footer tr td {
            height: 20px;
        }

        .item-table {
            border: 1px solid black;
        }

        .vat-table {
            border-top: 0px;
            border-bottom: 1px;
            border-left: 1px;
            border-right: 1px;
        }

        .information-table {
            border-top: 0px;
            border-bottom: 1px;
            border-left: 1px;
            border-right: 1px;
        }

            .information-table tr td {
                border-left: 1px;
                font-size: 12px !important;
            }

        .tabel-width {
            width: 100%;
            height: 1000px;
        }

        .font-size {
            font-size: 12px;
        }

        hr {
    border: none;
    height: 1px;
    color: #333; 
    background-color: #333; 
}
        /*table {
            border: 1px solid black;
        }*/
    </style>
</head>
<body>
    <img src="@imagePath\logo.jpeg" alt="mug shot" width="150px" height="150px" class="image" />
    <div style="padding:0px 10px 10px 240px; font-size:25px!important;">
        <strong>PURCHASE ORDER</strong>
    </div>
    <div style="padding:10px 10px; height:740px;">
        <!-- Repositioning of Date and PO number-->
        <div style=" position:relative; top: -108px; left: 525px;">
            <!--ID-->
            <table class="font-size table-purchase-order">
                <tr>
                    <td>
                        <strong>P.O. No.</strong>
                    </td>
                    <td>
                        <span style="color:#800000"> @((Model.RequisitionID).ToString("D4")) </span><!--babaguhin -->
                    </td>
                </tr>
                <tr>
                    <td>
                        <strong>P.O. Date</strong>
                    </td>
                    <td>
                        @String.Format("{0:MMMM dd, yyyy}", DateTime.Now) <!--babaguhin -->
                    </td>
                </tr>
                @*<tr>
                        <td>
                            <strong>Delivery Date</strong>
                        </td>
                        <td>

                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>Requisition No.</strong>
                        </td>
                        <td>

                        </td>
                    </tr>*@
            </table>
        </div>
        <div style="padding:0px 0px 10px 0px;">
            <!--INFORMATION-->
            <table class="font-size bordered-table" width="100%">
                <tr>
                    <th align="center">
                        SUPPLIER: @Model.SupplierName.ToString().ToUpper() <!--babaguhin -->
                    </th>
                    <th align="center">
                        SHIP TO: ANDERSON GROUP BPO INC.
                    </th>
                </tr>
                <tr>
                    <td width="40%">

                        <table class="font-size no-table-border">

                            <tr>
                                <td width="40px">
                                    <strong>Location: </strong> <!--With Location Label-->
                                </td>
                                <td colspan="7" style="height:40px!important;">
                                    @Model.SupplierAddress <!--Babaguhin-->
                                </td>
                            </tr>
                            <tr>
                                <td width="40px">
                                    <strong>Attention :</strong>
                                </td>
                                <td width="40px">
                                    @Model.ContactPerson <!--babaguhin -->
                                </td>

                            </tr>
                            <tr>
                                <td></td>
                                <td >
                                    Supplier <!--Babaguhin-->
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Tel No.:</strong></td>
                                <td>
                                    @Model.ContactNo <!--babaguhin -->
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Email:</strong></td>
                                <td>
                                    <span style="color:blue;text-decoration: underline;">@Model.SupplierEmail </span><!--babaguhin -->
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td width="40%">
                        <!-- Changed-->
                        <table class="font-size no-table-border">
                            <tr>
                                <td width="650px">
                                    <strong>Location: </strong> <!--With Location Label-->
                                </td>
                                <td colspan="7" style="height:40px!important;">
                                    @Model.LocationAddress <!--babaguhin -->
                                </td>
                            </tr>
                            <tr>
                                <td width="450px">
                                    <!-- changed positioning-->
                                    <strong>Attention :</strong>
                                </td>
                                <td width="700px">
                                    Catherine Villavelez <!--babaguhin -->
                                </td>

                            </tr>
                            <tr>
                                <td></td>
                                <td width="700px">
                                    Admin Assistant <!--babaguhin -->
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Tel No.:</strong></td>
                                <td width="700px">
                                    0917 5684 322 <!--babaguhin -->
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Email:</strong></td>
                                <td>
                                    <span style="color:blue;text-decoration: underline;">catherinev@andersongroup.uk.com</span><!--babaguhin -->
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <table class="font-size information-table" width="100%">
                <tr>
                    <td>
                        <strong>Requisition No.</strong>: RR-@String.Format("{0:yyy}", DateTime.Now)-@Model.RequisitionID.ToString("D4") <!--babaguhin -->
                    </td>
                    <td>
                        <strong>Required Date</strong>: @String.Format("{0:MMMM dd, yyyy}", @Model.RequiredDate)<!--babaguhin -->
                    </td>
                    <td>
                        <strong>Delivery Date</strong>: @String.Format("{0:MMMM dd, yyyy}", @Model.RequiredDate)<!--babaguhin -->
                    </td>
                    <td>
                        <strong>Pages</strong>: 1 of 1
                    </td>
                </tr>
            </table>
        </div>
        <div>
            @{
                double total = 0;
                double totalWithVat = 0;
                double totalPurchase = 0;
                double compwith = 0;
                int counter = 0;
            }
            <!--ITEMS-->
            <table class="font-size item-table" width="100%">
                <tr>
                    <th align="center">QTY</th>
                    <th align="center">UOM</th>
                    <th align="center">ITEM DESCRIPTION</th>
                    <th align="center" style="width:20px;">UNIT PRICE</th>
                    <th align="center" style="width:20px;">TOTAL</th>
                </tr> <!--Babaguhin-->
                @foreach (var item in Model.RequisitionItems)
                {
                    if (item.isItemSelected == true)
                    {
                        <tr class="font-size">
                            <td align="center">@item.Quantity</td>
                            <td align="center">@item.UnitOfMeasurement</td>
                            <td align="center">@item.ItemName</td>
                            @{
                        if (counter == 0)
                        {
                            <td align="center">P @item.RoundedUnitPrice </td>
                                <td align="center">P @item.LineTotal</td>
                        }
                        else
                        {
                            <td align="center">@item.RoundedUnitPrice</td><!--Replaced alignment-->
                                <td align="center">@item.LineTotal</td><!--Replaced alignment-->
                        }
                        counter++;
                            }
                        </tr>
                    }
                    total += Double.Parse(item.LineTotal);
                }
            </table>
           
            <!--COMPUTATION-->
            <!-- Spacing -->
            <br />
            <br />
            <br />
            <table class="font-size" width="100%">
                <tr class="item-footer">
                    <td width="52%">
                        <p align="justify">
                            <table style="font-size:10px;">

                                <tr>
                                    <td>
                                        1. Please send two copies of your invoice
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        2. Enter this order in accordance with the price, terms and delivery method, and specification
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        listed above
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        3. Please notify us immediately if you are unable to deliver / ship as specified
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        4. Send all the correspondence to Anderson Group Business Holdings Limited Philippines
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        5. For clarifications on this P.O., please contact Catherine Villavelez at (02) 556 5199  /
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        (0917) 568 4322 or email catherinev@andersongroup.uk.com
                                    </td>
                                </tr>

                            </table>
                        </p>
                    </td>
                    <td width="31%">
                        @{
                            if (Model.Vatable)
                            {
                                totalWithVat = (total / 1.12) * .12;
                                totalPurchase = total + totalWithVat;
                            }
                            else
                            {
                                totalPurchase = total;
                            }
                        }
                        <table style="font-size:10px;">
                            <tr>
                                <td align="center">TOTAL</td>
                                <td align="right">
                                    P @String.Format("{0:n}", total) <!--babaguhin-->
                                </td>
                            </tr>
                            <tr>
                                <td align="center">12% VAT (inclusive)</td>
                                <td align="right">
                                    P @String.Format("{0:n}", totalWithVat)<!--babaguhin-->
                                </td>
                            </tr>
                            <tr>
                            
                            <td align="center">W/HOLDING TAX</td>
                            
                            <td align="right">
                                                                    @String.Format("{0:n}", (compwith = Model.WholdingTax * .1))% <!--babaguhin-->
                                
                            </td>
                            
                </tr>
                <tr>
                    <td align="center">TOTAL PURCHASE</td>
                    <td align="right">
                        P @String.Format("{0:n}", totalPurchase)<!--babaguhin-->
                    </td>
                </tr>
                <tr>
                    <td align="center">DELIVERY CHARGES </td>
                    <td align="right">
                        P @String.Format("{0:n}", Model.DeliveryCharge)<!--babaguhin-->
                    </td>
                </tr>
                @*<tr>
                <td align="center">W/holding Tax </td>
                <td align="right">
                    P @String.Format("{0:n}", Model.WholdingTax)
                </td>
            </tr>*@
                @*<tr>
                <td align="center">OTHERS</td>
                <td  align="right">100</td>
            </tr>*@
                            
                <tr>
                    <td align="center"><strong> GRAND TOTAL</strong></td>
                    <td align="right">
                        <strong> P @String.Format("{0:n}", (Model.DeliveryCharge + totalPurchase + compwith))</strong><!--babaguhin-->
                    </td>
                </tr>
            </table>
                    </td>
                </tr>

            </table>
        </div>
        <br />
        <div>
            <br />

            <!-- Spacing -->
            <!--SIGNATURE-->
            <table width="100%">
                <tr>
                    <td>
                        <table style="font-size:11px;">
                            <tr>
                                <td width="10px"></td>
                                <td>
                                    <strong>Prepared by:</strong><br /><br /><br /><br />

                                    <strong class="underlined-text">Catherine Villavelez</strong><!--Underlined Text-->
                                </td>
                                <td width="100px"></td>
                            </tr>
                            <tr>
                                <td></td>


                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <strong>Administrative Assistant </strong><!--Babaguhin-->
                                </td>
                            </tr>
                            
                        </table>
                    </td>
                    <td>
                        <table style="font-size:11px;">
                            <tr>
                                <td width="80px"></td>
                                <td>
                                    <strong>Approved by:</strong><br /><br /><br /><br />
                                    <strong class="underlined-text">Grace Abigail C. Bagatsing</strong><!--Babaguhin-->
                                </td>
                                <td width="50px"></td>
                            </tr>
                            <tr>
                                <td></td>



                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <strong>Country Director</strong><!--Babaguhin-->
                                </td>
                            </tr>
                            
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <hr/>
    <table style="font-size:11px;" align="center"> <!--Revamped the footer in PDF with Location and Telephone Number Update-->
        <tr>
            <td align="center">
                BGC Branch: Ecotower Building Unit 1504, 32nd Street corner 9th avenue Bonifacio Global City, Taguig City Philippines
            </td>
        </tr>
        <tr>
            <td align="center">Ortigas Branch: 11/F Wynsum Corporate Plaza, #22 F. Ortigas Jr. Road Ortigas Center,Pasig City Philippines</td>
        </tr>
        <tr>
            <td align="center">
                Mandaluyong Branch: 20th floor, Robinsons Cybergate 3, Pioneer St, Mandaluyong, Metro Manila, Philippines
            </td>
        </tr>
        <tr>
            <td align="center">
                Tel: 491-7325
            </td>
        </tr>
        <tr>
            <td align="center">
                andersongroup.ph
            </td>
        </tr>
    </table>
</body>
</html>